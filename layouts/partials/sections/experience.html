{{ if .Site.Params.experience.enable | default false }}
<section id="experience" class="py-5">
    <div class="container">
        <h3 class="text-center">{{ .Site.Params.experience.title | default "Experience" }}</h3>
        <div class="row justify-content-center">
            <div class="col-sm-12 col-md-8 col-lg-8 py-5">
                <div class="experience-container px-3 pt-2">
                    <ul class="nav nav-pills mb-3 bg-transparent primary-font" id="pills-tab" role="tablist">
                        <script>
                            var companies = {}; // Objek untuk menyimpan perusahaan dan indeksnya
                            var activeCompany = ''; // Variabel untuk menyimpan perusahaan aktif
                            {{ range $index, $element := .Site.Params.experience.items }}
                                var company = "{{ .company }}";
                                if (!companies[company]) { // Jika perusahaan belum ada dalam objek, tambahkan
                                    companies[company] = []; // Inisialisasi array untuk perusahaan
                                }
                                companies[company].push({ index: {{ $index }} }); // Tambahkan indeks ke dalam array perusahaan
                            {{ end }}
                            // Fungsi untuk menampilkan tab-pane berdasarkan perusahaan yang dipilih
                            function showTabPane(company) {
                                var panes = document.querySelectorAll('.tab-pane'); // Ambil semua elemen tab-pane
                                panes.forEach(function(pane) {
                                    pane.classList.remove('show', 'active'); // Hapus kelas show dan active dari semua tab-pane
                                });
                                companies[company].forEach(function(item) { // Tampilkan tab-pane untuk perusahaan yang dipilih
                                    panes[item.index].classList.add('show', 'active'); // Tambahkan kelas show dan active pada tab-pane yang sesuai
                                });
                                activeCompany = company; // Perbarui perusahaan aktif
                            }
                            // Jalankan fungsi showTabPane untuk perusahaan pertama
                            showTabPane(Object.keys(companies)[0]);
                        </script>
                        {{ range $key, $value := .Site.Params.experience.items }}
                            <li class="nav-item px-1 bg-transparent" role="presentation">
                                <div 
                                    class="nav-link bg-transparent" 
                                    aria-selected="false" 
                                    role="tab" 
                                    data-bs-toggle="pill"
                                    id='{{ replace $key.company " " "-" }}-{{ replace $key.date " " "-" }}-tab'
                                    data-bs-target='#pills-{{ replace $key.company " " "-" }}-{{ replace $key.date " " "-" }}' 
                                    aria-controls='{{ replace $key.company " " "-" }}-{{ replace $key.date " " "-" }}'
                                    onclick="showTabPane('{{ $key.company }}')"
                                >
                                    {{ $key.company }}
                                </div>
                            </li>
                        {{ end }}
                    </ul>
                    <div class="tab-content pb-5 pt-2 bg-transparent primary-font" id="pills-tabContent">
                        {{ range $index, $element := .Site.Params.experience.items }}
                            <div class="tab-pane fade {{ if in $element.company activeCompany }}show active{{ else }}bg-transparent{{ end }}" role="tabpanel" id="pills-{{ .company | replaceRE "\\s+" "-" }}" aria-labelledby="pills-{{ .company | replaceRE "\\s+" "-" }}-tab">
                                <div>
                                    <span class="h4">{{ .job }}</span>
                                    <small>-</small>
                                    <a href="{{ .companyUrl }}" target="_blank">{{ .company }}</a>
                                    <div class="pb-1">
                                        <small>{{ .date }}</small>
                                        {{ if .info.enable | default true }}
                                        <span class="p-2">
                                            <span 
                                                style="cursor: pointer;" 
                                                data-bs-toggle="tooltip" 
                                                data-bs-placement="top" 
                                                data-bs-original-title={{ .info.content | default (print "Worked as a " .job " at " .company ) }}
                                            > 
                                                <i class="fas fa-info-circle fa-xs"></i>
                                            </span>
                                        </span>
                                        {{ end }}
                                    </div>
                                    {{ if .featuredLink.enable | default false }}
                                    <div class="py-2 featuredLink">
                                        <a class="p-2 px-4 btn btn-outline-primary btn-sm" href={{ .featuredLink.url | default "#" }} target="_blank">
                                            {{ .featuredLink.name | default "Featured Link" }} 
                                        </a>
                                    </div>
                                    {{ end }}
                                </div>
                                <div class="pt-2">
                                    {{ .content | markdownify}}
                                </div>
                            </div>
                        {{ end }}
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>
{{ end }}
